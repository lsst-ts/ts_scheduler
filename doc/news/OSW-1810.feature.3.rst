Optimized the target queue generation to produce a single target at a time using 'select_next_target'.
